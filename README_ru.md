# Проект планирования видового состава

|           |                                                                                                                                                   |
|----------:|:-------------------------------------------------------------------------------------------------------------------------------------------------:|
| Лицензия  | ![Licence](https://img.shields.io/badge/License-MIT-yellow.svg)                                                                                   |
| Переводы  | [![english](https://img.shields.io/badge/lang-en-red.svg)](README.md) [![russian](https://img.shields.io/badge/lang-ru-yellow.svg)](README_ru.md) |

Репозиторий проекта НИР: № 622263 «Планирование видового состава городских зеленых насаждений при помощи сетевого моделирования».

## Структура проекта

- [**backend**](backend/README.md) - бэкенд-сервис, позволяющий получать доступ к данных о растениях (включая загрузку и обновление),
    а также поддерживающий схему базы данных в актуальном состоянии.
- [**frontend**](frontend/README.md) - фронтенд на Flutter, собираемый в веб-интерфейс, позже выдающийся статикой через Nginx
- [**photos**](photos/README.md) - Docker-сервис выдачи фотографий растений и скрипты подготовки и вставки имеющихся изображений.
- **compositioner** - основной метод создания видового состава, работа с графами и другие скрипты.

## Описание

В данном проекте мы представляем алгоритм создания видового состава, способный генерировать новые наборы
    растений, рекоммендованных к высадке на заданных зеленых зонах с учетом возможного имеющегося состава.
    Алгоритм учитывает внешние, внутренние и антропогенные факторы, такие как освещенность, сочетаемость растений
    или засоленность почвы. Работа алгоритма состоит из двух основных этапов: пространственный анализ территории,
    выбранной пользователем, чтобы выбрать список растений, которым подходят условия, и этап сетевого моделирования,
    где на граф сочетаемости применяется метод разделения групп для генерации нескольких вариантов видового состава.

## Общая схема работы

![Общая схема работы](https://news.egov.itmo.ru/photo/algoritm_nahozhdeniya_kompozicij_rastenij-1.png)

## Пример работы

Для создания базы данных следует выполнить миграции Alembic в [модуле бэкенда](backend/README.md)
    и загрузки данных растений в сервис,
    а шаги 1-8 выполняются с помощью `update_current_composition`, `get_recommended_composition`
    и `get_composition_unknown` функций из [модуля get_composition](method/get_composition.py).

0. Подготовка базы данных и заполнение ее растениями и их свойствами.

1. Создание графа сочетаемости, основанном на информации о сочетаемости из базы данных.

    <img src="docs/compatability_graph.png" alt="Граф сочетаемостей" width="50%" height="50%"/>

2. Выбор области для генерации породного состава.

    <img src="docs/green_area.png" alt="area" width="50%" height="50%"/>

3. Подготовка слоя освещенности.

4. Подготовка слоя внешних лимитирующих факторов.

    <img src="docs/limitation_factors.png" alt="Лимитирующие факторы" width="50%" height="50%"/>

5. Выбор набора растений, которым подходит освещенноть, и которые способны выдерживать лимитирующие факторы для заданной обалсти.

6. Создание подграфа графа сочетаемости с отобранными ранее растениями.
    <img src="docs/original_graph.png" alt="Подграф с отобранными растениями" width="50%" height="50%"/>

7. Использование метода разделение групп для создания вариантов видового сотава.

    - Вариант 1:

    <img src="docs/updated_graph_1.png" alt="Вариант видового состава 1" width="50%" height="50%"/>

    - Вариант 2:

    <img src="docs/updated_graph_2.png" alt="Вариант видового состава 2" width="50%" height="50%"/>
